TYPE=VIEW
query=select `cbwebca_bd01`.`plan`.`plan_id` AS `plan_id`,`cbwebca_bd01`.`plan`.`parent_id` AS `parent_id`,`cbwebca_bd01`.`plan`.`objectif_id` AS `objectif_id`,`cbwebca_bd01`.`plan`.`code` AS `code`,`cbwebca_bd01`.`plan`.`poids` AS `poids`,`cbwebca_bd01`.`plan`.`note` AS `note`,substring_index(`cbwebca_bd01`.`plan`.`code_wbs`,\'.\',1) AS `plan_code_wbs`,concat(substring_index(`cbwebca_bd01`.`plan`.`code_wbs`,\'.\',1),\'-\',`pplan_objectif`.`libelle`) AS `plan_libelle`,`cbwebca_bd01`.`plan`.`code_wbs` AS `code_wbs`,`cbwebca_bd01`.`plan`.`niveau` AS `niveau`,`v_objectif`.`type_objectif_id` AS `type_objectif_id`,`v_objectif`.`type_objectif_code` AS `type_objectif_code`,`v_objectif`.`type_objectif_libelle` AS `type_objectif_libelle`,`v_objectif`.`type_objectif_css` AS `type_objectif_css`,`v_objectif`.`type_objectif_classe` AS `type_objectif_classe`,`v_objectif`.`libelle` AS `libelle`,`v_objectif`.`descr` AS `descr`,`v_objectif`.`code` AS `objectif_code`,`v_objectif`.`debut_date` AS `debut_date`,`v_objectif`.`fin_date` AS `fin_date`,`v_objectif`.`attributs` AS `attributs`,`v_objectif`.`attributs_desc` AS `attributs_desc`,`v_objectif`.`responsable_personnel_id` AS `responsable_personnel_id`,`v_objectif`.`responsable_nom` AS `responsable_nom`,`v_objectif`.`responsable_prenom` AS `responsable_prenom`,`v_objectif`.`responsable_courriel` AS `responsable_courriel`,`v_objectif`.`responsable_departement_id` AS `responsable_departement_id`,`v_objectif`.`responsable_departement_code` AS `responsable_departement_code`,`v_objectif`.`responsable_direction_id` AS `responsable_direction_id`,`v_objectif`.`responsable_direction_code` AS `responsable_direction_code`,`v_objectif`.`reddition_date` AS `reddition_date`,`v_objectif`.`budget_effectif_date` AS `budget_effectif_date`,`v_objectif`.`codes_reddition_codes` AS `codes_reddition_codes`,`v_objectif`.`codes_reddition_codes_desc` AS `codes_reddition_codes_desc`,`v_objectif`.`attribut_decompte` AS `attribut_decompte`,`v_objectif`.`personnel_decompte` AS `personnel_decompte`,`v_objectif`.`plan_decompte` AS `plan_decompte`,`v_objectif`.`valeur_decompte` AS `valeur_decompte`,`v_objectif`.`budget_decompte` AS `budget_decompte`,`v_objectif`.`reddition_decompte` AS `reddition_decompte`,`v_objectif`.`suivi_decompte` AS `suivi_decompte`,(select count(0) from `cbwebca_bd01`.`plan` `a` where `a`.`plan_id` = `cbwebca_bd01`.`plan`.`parent_id`) AS `plan_parent_decompte`,(select count(0) from `cbwebca_bd01`.`plan` `a` where `a`.`parent_id` = `cbwebca_bd01`.`plan`.`plan_id`) AS `plan_enfant_decompte`,`v_objectif`.`cible` AS `cible`,`v_objectif`.`sens` AS `sens`,case when `v_objectif`.`sens` = \'HAUT\' then 1 else 0 end AS `sens_no`,`v_objectif`.`valeur` AS `valeur`,`v_objectif`.`valeur_effectif_date` AS `valeur_effectif_date`,`v_objectif`.`cible_ecart` AS `cible_ecart`,`v_objectif`.`cible_completion` AS `cible_completion`,`v_objectif`.`ind_termine` AS `ind_termine`,if(`v_objectif`.`statut_id` = 60 or `cbwebca_bd01`.`plan`.`z_statut_id` = 60,NULL,if(`v_objectif`.`reddition_date` is null,`cbwebca_bd01`.`plan`.`decompte`,1)) AS `decompte`,if(`v_objectif`.`statut_id` = 60 or `cbwebca_bd01`.`plan`.`z_statut_id` = 60,NULL,if(`v_objectif`.`reddition_date` is null,`cbwebca_bd01`.`plan`.`completion_pourcent_total`,`v_objectif`.`completion_pourcent`)) AS `completion_pourcent_total`,if(`v_objectif`.`statut_id` = 60 or `cbwebca_bd01`.`plan`.`z_statut_id` = 60,NULL,if(`v_objectif`.`reddition_date` is null,`cbwebca_bd01`.`plan`.`termine_decompte`,`v_objectif`.`termine_decompte`)) AS `termine_decompte`,if(`v_objectif`.`statut_id` = 60 or `cbwebca_bd01`.`plan`.`z_statut_id` = 60,NULL,if(`v_objectif`.`reddition_date` is null,ifnull(`cbwebca_bd01`.`plan`.`reddition_debut_date`,`v_objectif`.`debut_date`),`v_objectif`.`reddition_debut_date`)) AS `reddition_debut_date`,if(`v_objectif`.`statut_id` = 60 or `cbwebca_bd01`.`plan`.`z_statut_id` = 60,NULL,if(`v_objectif`.`reddition_date` is null,ifnull(`cbwebca_bd01`.`plan`.`reddition_fin_date`,`v_objectif`.`fin_date`),`v_objectif`.`reddition_fin_date`)) AS `reddition_fin_date`,if(`v_objectif`.`statut_id` = 60 or `cbwebca_bd01`.`plan`.`z_statut_id` = 60,NULL,if(`v_objectif`.`budget_effectif_date` is null,`cbwebca_bd01`.`plan`.`budget_total`,`v_objectif`.`budget_total`)) AS `budget_total`,if(`v_objectif`.`statut_id` = 60 or `cbwebca_bd01`.`plan`.`z_statut_id` = 60,NULL,if(`v_objectif`.`budget_effectif_date` is null,`cbwebca_bd01`.`plan`.`budget_depense`,`v_objectif`.`budget_depense`)) AS `budget_depense`,if(`v_objectif`.`statut_id` = 60 or `cbwebca_bd01`.`plan`.`z_statut_id` = 60,NULL,if(`v_objectif`.`budget_effectif_date` is null,`cbwebca_bd01`.`plan`.`budget_engage`,`v_objectif`.`budget_engage`)) AS `budget_engage`,case when `v_objectif`.`reddition_date` is not null then `v_objectif`.`duree` else to_days(`cbwebca_bd01`.`plan`.`reddition_fin_date`) - to_days(`cbwebca_bd01`.`plan`.`reddition_debut_date`) end AS `duree`,case when `v_objectif`.`reddition_date` is not null then `v_objectif`.`jours_restants` else case when to_days(`cbwebca_bd01`.`plan`.`fin_date`) - to_days(`cbwebca_bd01`.`plan`.`reddition_date`) < 0 then 0 else to_days(`cbwebca_bd01`.`plan`.`fin_date`) - to_days(`cbwebca_bd01`.`plan`.`reddition_date`) end end AS `jours_restants`,case when `v_objectif`.`reddition_date` is not null then `v_objectif`.`cycle_pourcent` else case when round((to_days(`cbwebca_bd01`.`plan`.`fin_date`) - to_days(`cbwebca_bd01`.`plan`.`reddition_date`)) * 100 / (to_days(`cbwebca_bd01`.`plan`.`fin_date`) - to_days(`cbwebca_bd01`.`plan`.`reddition_debut_date`)),0) < 0 then 0 else round((to_days(`cbwebca_bd01`.`plan`.`fin_date`) - to_days(`cbwebca_bd01`.`plan`.`reddition_date`)) * 100 / (to_days(`cbwebca_bd01`.`plan`.`fin_date`) - to_days(`cbwebca_bd01`.`plan`.`reddition_debut_date`)),0) end end AS `cycle_pourcent`,case when `v_objectif`.`reddition_date` is not null then `v_objectif`.`completion_pourcent` else round(`cbwebca_bd01`.`plan`.`completion_pourcent_total` / `cbwebca_bd01`.`plan`.`decompte`,0) end AS `completion_pourcent`,case when `v_objectif`.`reddition_date` is not null then `v_objectif`.`termine_decompte` else round(`cbwebca_bd01`.`plan`.`termine_decompte` * 100 / `cbwebca_bd01`.`plan`.`decompte`,0) end AS `termine_pourcent`,case when `v_objectif`.`budget_effectif_date` is not null then round((`v_objectif`.`budget_depense` + `v_objectif`.`budget_engage`) * 100 / `v_objectif`.`budget_total`,0) else round((`cbwebca_bd01`.`plan`.`budget_depense` + `cbwebca_bd01`.`plan`.`budget_engage`) * 100 / `cbwebca_bd01`.`plan`.`budget_total`,0) end AS `budget_pourcent`,`cbwebca_bd01`.`statut`.`statut_id` AS `statut_id`,`cbwebca_bd01`.`statut`.`css` AS `statut_css`,`cbwebca_bd01`.`statut`.`icone` AS `statut_icone`,`cbwebca_bd01`.`statut`.`libelle` AS `statut`,case when `n1`.`niveau` = 1 then left(concat(`n1`.`code_wbs`,\'-\',`on1`.`libelle`),500) when `n2`.`niveau` = 1 then left(concat(`n2`.`code_wbs`,\'-\',`on2`.`libelle`),500) when `n3`.`niveau` = 1 then left(concat(`n3`.`code_wbs`,\'-\',`on3`.`libelle`),500) when `n4`.`niveau` = 1 then left(concat(`n4`.`code_wbs`,\'-\',`on4`.`libelle`),500) when `n5`.`niveau` = 1 then left(concat(`n5`.`code_wbs`,\'-\',`on5`.`libelle`),500) when `n6`.`niveau` = 1 then left(concat(`n6`.`code_wbs`,\'-\',`on6`.`libelle`),500) when `n7`.`niveau` = 1 then left(concat(`n7`.`code_wbs`,\'-\',`on7`.`libelle`),500) end AS `plan_niveau_1`,case when `n1`.`niveau` = 2 then left(concat(`n1`.`code_wbs`,\'-\',`on1`.`libelle`),500) when `n2`.`niveau` = 2 then left(concat(`n2`.`code_wbs`,\'-\',`on2`.`libelle`),500) when `n3`.`niveau` = 2 then left(concat(`n3`.`code_wbs`,\'-\',`on3`.`libelle`),500) when `n4`.`niveau` = 2 then left(concat(`n4`.`code_wbs`,\'-\',`on4`.`libelle`),500) when `n5`.`niveau` = 2 then left(concat(`n5`.`code_wbs`,\'-\',`on5`.`libelle`),500) when `n6`.`niveau` = 2 then left(concat(`n6`.`code_wbs`,\'-\',`on6`.`libelle`),500) when `n7`.`niveau` = 2 then left(concat(`n7`.`code_wbs`,\'-\',`on7`.`libelle`),500) end AS `plan_niveau_2`,case when `n1`.`niveau` = 3 then left(concat(`n1`.`code_wbs`,\'-\',`on1`.`libelle`),500) when `n2`.`niveau` = 3 then left(concat(`n2`.`code_wbs`,\'-\',`on2`.`libelle`),500) when `n3`.`niveau` = 3 then left(concat(`n3`.`code_wbs`,\'-\',`on3`.`libelle`),500) when `n4`.`niveau` = 3 then left(concat(`n4`.`code_wbs`,\'-\',`on4`.`libelle`),500) when `n5`.`niveau` = 3 then left(concat(`n5`.`code_wbs`,\'-\',`on5`.`libelle`),500) when `n6`.`niveau` = 3 then left(concat(`n6`.`code_wbs`,\'-\',`on6`.`libelle`),500) when `n7`.`niveau` = 3 then left(concat(`n7`.`code_wbs`,\'-\',`on7`.`libelle`),500) end AS `plan_niveau_3`,case when `n1`.`niveau` = 4 then left(concat(`n1`.`code_wbs`,\'-\',`on1`.`libelle`),500) when `n2`.`niveau` = 4 then left(concat(`n2`.`code_wbs`,\'-\',`on2`.`libelle`),500) when `n3`.`niveau` = 4 then left(concat(`n3`.`code_wbs`,\'-\',`on3`.`libelle`),500) when `n4`.`niveau` = 4 then left(concat(`n4`.`code_wbs`,\'-\',`on4`.`libelle`),500) when `n5`.`niveau` = 4 then left(concat(`n5`.`code_wbs`,\'-\',`on5`.`libelle`),500) when `n6`.`niveau` = 4 then left(concat(`n6`.`code_wbs`,\'-\',`on6`.`libelle`),500) when `n7`.`niveau` = 4 then left(concat(`n7`.`code_wbs`,\'-\',`on7`.`libelle`),500) end AS `plan_niveau_4`,case when `n1`.`niveau` = 5 then left(concat(`n1`.`code_wbs`,\'-\',`on1`.`libelle`),500) when `n2`.`niveau` = 5 then left(concat(`n2`.`code_wbs`,\'-\',`on2`.`libelle`),500) when `n3`.`niveau` = 5 then left(concat(`n3`.`code_wbs`,\'-\',`on3`.`libelle`),500) when `n4`.`niveau` = 5 then left(concat(`n4`.`code_wbs`,\'-\',`on4`.`libelle`),500) when `n5`.`niveau` = 5 then left(concat(`n5`.`code_wbs`,\'-\',`on5`.`libelle`),500) when `n6`.`niveau` = 5 then left(concat(`n6`.`code_wbs`,\'-\',`on6`.`libelle`),500) when `n7`.`niveau` = 5 then left(concat(`n7`.`code_wbs`,\'-\',`on7`.`libelle`),500) end AS `plan_niveau_5`,case when `n1`.`niveau` = 6 then left(concat(`n1`.`code_wbs`,\'-\',`on1`.`libelle`),500) when `n2`.`niveau` = 6 then left(concat(`n2`.`code_wbs`,\'-\',`on2`.`libelle`),500) when `n3`.`niveau` = 6 then left(concat(`n3`.`code_wbs`,\'-\',`on3`.`libelle`),500) when `n4`.`niveau` = 6 then left(concat(`n4`.`code_wbs`,\'-\',`on4`.`libelle`),500) when `n5`.`niveau` = 6 then left(concat(`n5`.`code_wbs`,\'-\',`on5`.`libelle`),500) when `n6`.`niveau` = 6 then left(concat(`n6`.`code_wbs`,\'-\',`on6`.`libelle`),500) when `n7`.`niveau` = 6 then left(concat(`n7`.`code_wbs`,\'-\',`on7`.`libelle`),500) end AS `plan_niveau_6`,case when `n1`.`niveau` = 7 then left(concat(`n1`.`code_wbs`,\'-\',`on1`.`libelle`),500) when `n2`.`niveau` = 7 then left(concat(`n2`.`code_wbs`,\'-\',`on2`.`libelle`),500) when `n3`.`niveau` = 7 then left(concat(`n3`.`code_wbs`,\'-\',`on3`.`libelle`),500) when `n4`.`niveau` = 7 then left(concat(`n4`.`code_wbs`,\'-\',`on4`.`libelle`),500) when `n5`.`niveau` = 7 then left(concat(`n5`.`code_wbs`,\'-\',`on5`.`libelle`),500) when `n6`.`niveau` = 7 then left(concat(`n6`.`code_wbs`,\'-\',`on6`.`libelle`),500) when `n7`.`niveau` = 7 then left(concat(`n7`.`code_wbs`,\'-\',`on7`.`libelle`),500) end AS `plan_niveau_7` from ((((((((((((((((((`cbwebca_bd01`.`plan` join `cbwebca_bd01`.`v_objectif` on(`v_objectif`.`objectif_id` = `cbwebca_bd01`.`plan`.`objectif_id`)) left join `cbwebca_bd01`.`statut` on(`cbwebca_bd01`.`statut`.`statut_id` = `cbwebca_bd01`.`plan`.`z_statut_id`)) left join `cbwebca_bd01`.`plan` `pplan` on(`pplan`.`code_wbs` = substring_index(`cbwebca_bd01`.`plan`.`code_wbs`,\'.\',1))) left join `cbwebca_bd01`.`v_objectif` `pplan_objectif` on(`pplan_objectif`.`objectif_id` = `pplan`.`objectif_id`)) left join `cbwebca_bd01`.`plan` `n1` on(`n1`.`plan_id` = `cbwebca_bd01`.`plan`.`parent_id`)) left join `cbwebca_bd01`.`objectif` `on1` on(`on1`.`objectif_id` = `n1`.`objectif_id`)) left join `cbwebca_bd01`.`plan` `n2` on(`n2`.`plan_id` = `n1`.`parent_id`)) left join `cbwebca_bd01`.`objectif` `on2` on(`on2`.`objectif_id` = `n2`.`objectif_id`)) left join `cbwebca_bd01`.`plan` `n3` on(`n3`.`plan_id` = `n2`.`parent_id`)) left join `cbwebca_bd01`.`objectif` `on3` on(`on3`.`objectif_id` = `n3`.`objectif_id`)) left join `cbwebca_bd01`.`plan` `n4` on(`n4`.`plan_id` = `n3`.`parent_id`)) left join `cbwebca_bd01`.`objectif` `on4` on(`on4`.`objectif_id` = `n4`.`objectif_id`)) left join `cbwebca_bd01`.`plan` `n5` on(`n5`.`plan_id` = `n4`.`parent_id`)) left join `cbwebca_bd01`.`objectif` `on5` on(`on5`.`objectif_id` = `n5`.`objectif_id`)) left join `cbwebca_bd01`.`plan` `n6` on(`n6`.`plan_id` = `n5`.`parent_id`)) left join `cbwebca_bd01`.`objectif` `on6` on(`on6`.`objectif_id` = `n6`.`objectif_id`)) left join `cbwebca_bd01`.`plan` `n7` on(`n7`.`plan_id` = `n6`.`parent_id`)) left join `cbwebca_bd01`.`objectif` `on7` on(`on7`.`objectif_id` = `n7`.`objectif_id`))
md5=e3a0b6c3cc663795a8997f244e79bfc5
updatable=0
algorithm=0
definer_user=root
definer_host=localhost
suid=2
with_check_option=0
timestamp=2021-11-22 23:35:41
create-version=2
source=SELECT		plan.plan_id\n				,plan.parent_id\n				,plan.objectif_id\n				,plan.code\n				,plan.poids\n				,plan.note\n\n				,SUBSTRING_INDEX( plan.code_wbs, \'.\', 1 ) AS plan_code_wbs\n				,CONCAT( SUBSTRING_INDEX( plan.code_wbs, \'.\', 1 ), \'-\', PPLAN_OBJECTIF.libelle ) AS plan_libelle\n\n				,plan.code_wbs\n				,plan.niveau\n				,v_objectif.type_objectif_id\n				,v_objectif.type_objectif_code\n				,v_objectif.type_objectif_libelle\n				,v_objectif.type_objectif_css\n				,v_objectif.type_objectif_classe\n				,v_objectif.libelle\n				,v_objectif.descr\n				,v_objectif.code AS objectif_code\n				,v_objectif.debut_date\n				,v_objectif.fin_date\n				,v_objectif.attributs\n				,v_objectif.attributs_desc\n				,v_objectif.responsable_personnel_id\n				,v_objectif.responsable_nom\n				,v_objectif.responsable_prenom\n				,v_objectif.responsable_courriel\n				,v_objectif.responsable_departement_id\n				,v_objectif.responsable_departement_code\n				,v_objectif.responsable_direction_id\n				,v_objectif.responsable_direction_code\n				,v_objectif.reddition_date\n				,v_objectif.budget_effectif_date\n				,v_objectif.codes_reddition_codes\n				,v_objectif.codes_reddition_codes_desc\n\n				,v_objectif.attribut_decompte\n				,v_objectif.personnel_decompte\n				,v_objectif.plan_decompte\n				,v_objectif.valeur_decompte\n				,v_objectif.budget_decompte\n				,v_objectif.reddition_decompte\n				,v_objectif.suivi_decompte\n\n				/*\n				,v_objectif.plan_parent_decompte\n				,v_objectif.plan_enfant_decompte\n				*/\n				,( SELECT COUNT(*) FROM plan A WHERE A.plan_id = plan.parent_id ) AS plan_parent_decompte\n				,( SELECT COUNT(*) FROM plan A WHERE A.parent_id = plan.plan_id ) AS plan_enfant_decompte\n\n				,v_objectif.cible\n				,v_objectif.sens\n				,CASE WHEN v_objectif.sens = \'HAUT\' THEN 1 ELSE 0 END AS sens_no\n				,v_objectif.valeur\n				,v_objectif.valeur_effectif_date\n				,v_objectif.cible_ecart\n				,v_objectif.cible_completion\n\n				,v_objectif.ind_termine\n\n				,IF( ( v_objectif.statut_id = 60 OR plan.z_statut_id = 60 ), NULL, IF( v_objectif.reddition_date IS NULL, plan.decompte, 1 ) ) AS decompte\n				,IF( ( v_objectif.statut_id = 60 OR plan.z_statut_id = 60 ), NULL, IF( v_objectif.reddition_date IS NULL, plan.completion_pourcent_total, v_objectif.completion_pourcent ) ) AS completion_pourcent_total\n				,IF( ( v_objectif.statut_id = 60 OR plan.z_statut_id = 60 ), NULL, IF( v_objectif.reddition_date IS NULL, plan.termine_decompte, v_objectif.termine_decompte ) ) AS termine_decompte\n				,IF( ( v_objectif.statut_id = 60 OR plan.z_statut_id = 60 ), NULL, IF( v_objectif.reddition_date IS NULL, IFNULL( plan.reddition_debut_date, v_objectif.debut_date ), v_objectif.reddition_debut_date ) ) AS reddition_debut_date\n				,IF( ( v_objectif.statut_id = 60 OR plan.z_statut_id = 60 ), NULL, IF( v_objectif.reddition_date IS NULL, IFNULL( plan.reddition_fin_date, v_objectif.fin_date ), v_objectif.reddition_fin_date ) ) AS reddition_fin_date\n				,IF( ( v_objectif.statut_id = 60 OR plan.z_statut_id = 60 ), NULL, IF( v_objectif.budget_effectif_date IS NULL, plan.budget_total, v_objectif.budget_total ) ) AS budget_total\n				,IF( ( v_objectif.statut_id = 60 OR plan.z_statut_id = 60 ), NULL, IF( v_objectif.budget_effectif_date IS NULL, plan.budget_depense, v_objectif.budget_depense ) ) AS budget_depense\n				,IF( ( v_objectif.statut_id = 60 OR plan.z_statut_id = 60 ), NULL, IF( v_objectif.budget_effectif_date IS NULL, plan.budget_engage, v_objectif.budget_engage ) ) AS budget_engage\n\n				,CASE\n					WHEN v_objectif.reddition_date IS NOT NULL THEN v_objectif.duree\n					ELSE DATEDIFF( plan.reddition_fin_date, plan.reddition_debut_date )\n				END AS duree\n\n				,CASE\n					WHEN v_objectif.reddition_date IS NOT NULL THEN v_objectif.jours_restants\n					ELSE \n						CASE \n							WHEN DATEDIFF( plan.fin_date, plan.reddition_date ) < 0 THEN 0\n							ELSE DATEDIFF( plan.fin_date, plan.reddition_date )\n						END\n				END AS jours_restants\n\n				,CASE\n					WHEN v_objectif.reddition_date IS NOT NULL\n					THEN v_objectif.cycle_pourcent\n					ELSE \n						CASE \n							WHEN ROUND( DATEDIFF( plan.fin_date, plan.reddition_date ) * 100 / DATEDIFF( plan.fin_date, plan.reddition_debut_date ), 0 ) < 0 THEN 0\n							ELSE ROUND( DATEDIFF( plan.fin_date, plan.reddition_date ) * 100 / DATEDIFF( plan.fin_date, plan.reddition_debut_date ), 0 )\n						END\n				END AS cycle_pourcent\n\n				,CASE\n					WHEN v_objectif.reddition_date IS NOT NULL\n					THEN v_objectif.completion_pourcent \n					ELSE ROUND( ( plan.completion_pourcent_total ) / plan.decompte, 0 ) \n				END AS completion_pourcent\n\n				,CASE\n					WHEN v_objectif.reddition_date IS NOT NULL\n					THEN v_objectif.termine_decompte  \n					ELSE ROUND( ( plan.termine_decompte * 100 ) / plan.decompte, 0 )  \n				END AS termine_pourcent\n\n				,CASE\n					WHEN v_objectif.budget_effectif_date IS NOT NULL\n					THEN ROUND( ( v_objectif.budget_depense + v_objectif.budget_engage ) * 100 / v_objectif.budget_total, 0 )  \n					ELSE ROUND( ( plan.budget_depense + plan.budget_engage ) * 100 / plan.budget_total, 0 ) \n				END AS budget_pourcent\n\n				/* Statut */\n				/*\n				,CASE WHEN v_objectif.reddition_date IS NOT NULL THEN objectif_statut.statut_id ELSE plan_statut.statut_id END AS statut_id\n				,CASE WHEN v_objectif.reddition_date IS NOT NULL THEN objectif_statut.css ELSE plan_statut.css END AS statut_css\n				,CASE WHEN v_objectif.reddition_date IS NOT NULL THEN objectif_statut.icone ELSE plan_statut.icone END AS statut_icone\n				,CASE WHEN v_objectif.reddition_date IS NOT NULL THEN objectif_statut.libelle ELSE plan_statut.libelle END AS statut\n				*/\n				,statut.statut_id\n				,statut.css AS statut_css\n				,statut.icone AS statut_icone\n				,statut.libelle AS statut\n\n				,CASE \n					WHEN N1.niveau = 1 THEN LEFT( CONCAT( N1.code_wbs, \'-\', ON1.libelle ), 500 )\n					WHEN N2.niveau = 1 THEN LEFT( CONCAT( N2.code_wbs, \'-\', ON2.libelle ), 500 )\n					WHEN N3.niveau = 1 THEN LEFT( CONCAT( N3.code_wbs, \'-\', ON3.libelle ), 500 )\n					WHEN N4.niveau = 1 THEN LEFT( CONCAT( N4.code_wbs, \'-\', ON4.libelle ), 500 )\n					WHEN N5.niveau = 1 THEN LEFT( CONCAT( N5.code_wbs, \'-\', ON5.libelle ), 500 )\n					WHEN N6.niveau = 1 THEN LEFT( CONCAT( N6.code_wbs, \'-\', ON6.libelle ), 500 )\n					WHEN N7.niveau = 1 THEN LEFT( CONCAT( N7.code_wbs, \'-\', ON7.libelle ), 500 )\n				END AS plan_niveau_1\n\n				,CASE \n					WHEN N1.niveau = 2 THEN LEFT( CONCAT( N1.code_wbs, \'-\', ON1.libelle ), 500 )\n					WHEN N2.niveau = 2 THEN LEFT( CONCAT( N2.code_wbs, \'-\', ON2.libelle ), 500 )\n					WHEN N3.niveau = 2 THEN LEFT( CONCAT( N3.code_wbs, \'-\', ON3.libelle ), 500 )\n					WHEN N4.niveau = 2 THEN LEFT( CONCAT( N4.code_wbs, \'-\', ON4.libelle ), 500 )\n					WHEN N5.niveau = 2 THEN LEFT( CONCAT( N5.code_wbs, \'-\', ON5.libelle ), 500 )\n					WHEN N6.niveau = 2 THEN LEFT( CONCAT( N6.code_wbs, \'-\', ON6.libelle ), 500 )\n					WHEN N7.niveau = 2 THEN LEFT( CONCAT( N7.code_wbs, \'-\', ON7.libelle ), 500 )\n				END AS plan_niveau_2\n\n				,CASE \n					WHEN N1.niveau = 3 THEN LEFT( CONCAT( N1.code_wbs, \'-\', ON1.libelle ), 500 )\n					WHEN N2.niveau = 3 THEN LEFT( CONCAT( N2.code_wbs, \'-\', ON2.libelle ), 500 )\n					WHEN N3.niveau = 3 THEN LEFT( CONCAT( N3.code_wbs, \'-\', ON3.libelle ), 500 )\n					WHEN N4.niveau = 3 THEN LEFT( CONCAT( N4.code_wbs, \'-\', ON4.libelle ), 500 )\n					WHEN N5.niveau = 3 THEN LEFT( CONCAT( N5.code_wbs, \'-\', ON5.libelle ), 500 )\n					WHEN N6.niveau = 3 THEN LEFT( CONCAT( N6.code_wbs, \'-\', ON6.libelle ), 500 )\n					WHEN N7.niveau = 3 THEN LEFT( CONCAT( N7.code_wbs, \'-\', ON7.libelle ), 500 )\n				END AS plan_niveau_3\n				\n				,CASE \n					WHEN N1.niveau = 4 THEN LEFT( CONCAT( N1.code_wbs, \'-\', ON1.libelle ), 500 )\n					WHEN N2.niveau = 4 THEN LEFT( CONCAT( N2.code_wbs, \'-\', ON2.libelle ), 500 )\n					WHEN N3.niveau = 4 THEN LEFT( CONCAT( N3.code_wbs, \'-\', ON3.libelle ), 500 )\n					WHEN N4.niveau = 4 THEN LEFT( CONCAT( N4.code_wbs, \'-\', ON4.libelle ), 500 )\n					WHEN N5.niveau = 4 THEN LEFT( CONCAT( N5.code_wbs, \'-\', ON5.libelle ), 500 )\n					WHEN N6.niveau = 4 THEN LEFT( CONCAT( N6.code_wbs, \'-\', ON6.libelle ), 500 )\n					WHEN N7.niveau = 4 THEN LEFT( CONCAT( N7.code_wbs, \'-\', ON7.libelle ), 500 )\n				END AS plan_niveau_4\n\n				,CASE \n					WHEN N1.niveau = 5 THEN LEFT( CONCAT( N1.code_wbs, \'-\', ON1.libelle ), 500 )\n					WHEN N2.niveau = 5 THEN LEFT( CONCAT( N2.code_wbs, \'-\', ON2.libelle ), 500 )\n					WHEN N3.niveau = 5 THEN LEFT( CONCAT( N3.code_wbs, \'-\', ON3.libelle ), 500 )\n					WHEN N4.niveau = 5 THEN LEFT( CONCAT( N4.code_wbs, \'-\', ON4.libelle ), 500 )\n					WHEN N5.niveau = 5 THEN LEFT( CONCAT( N5.code_wbs, \'-\', ON5.libelle ), 500 )\n					WHEN N6.niveau = 5 THEN LEFT( CONCAT( N6.code_wbs, \'-\', ON6.libelle ), 500 )\n					WHEN N7.niveau = 5 THEN LEFT( CONCAT( N7.code_wbs, \'-\', ON7.libelle ), 500 )\n				END AS plan_niveau_5\n\n				,CASE \n					WHEN N1.niveau = 6 THEN LEFT( CONCAT( N1.code_wbs, \'-\', ON1.libelle ), 500 )\n					WHEN N2.niveau = 6 THEN LEFT( CONCAT( N2.code_wbs, \'-\', ON2.libelle ), 500 )\n					WHEN N3.niveau = 6 THEN LEFT( CONCAT( N3.code_wbs, \'-\', ON3.libelle ), 500 )\n					WHEN N4.niveau = 6 THEN LEFT( CONCAT( N4.code_wbs, \'-\', ON4.libelle ), 500 )\n					WHEN N5.niveau = 6 THEN LEFT( CONCAT( N5.code_wbs, \'-\', ON5.libelle ), 500 )\n					WHEN N6.niveau = 6 THEN LEFT( CONCAT( N6.code_wbs, \'-\', ON6.libelle ), 500 )\n					WHEN N7.niveau = 6 THEN LEFT( CONCAT( N7.code_wbs, \'-\', ON7.libelle ), 500 )\n				END AS plan_niveau_6\n\n				,CASE \n					WHEN N1.niveau = 7 THEN LEFT( CONCAT( N1.code_wbs, \'-\', ON1.libelle ), 500 )\n					WHEN N2.niveau = 7 THEN LEFT( CONCAT( N2.code_wbs, \'-\', ON2.libelle ), 500 )\n					WHEN N3.niveau = 7 THEN LEFT( CONCAT( N3.code_wbs, \'-\', ON3.libelle ), 500 )\n					WHEN N4.niveau = 7 THEN LEFT( CONCAT( N4.code_wbs, \'-\', ON4.libelle ), 500 )\n					WHEN N5.niveau = 7 THEN LEFT( CONCAT( N5.code_wbs, \'-\', ON5.libelle ), 500 )\n					WHEN N6.niveau = 7 THEN LEFT( CONCAT( N6.code_wbs, \'-\', ON6.libelle ), 500 )\n					WHEN N7.niveau = 7 THEN LEFT( CONCAT( N7.code_wbs, \'-\', ON7.libelle ), 500 )\n				END AS plan_niveau_7\n\n	FROM		plan\n	JOIN   		v_objectif 	ON v_objectif.objectif_id = plan.objectif_id\n	LEFT JOIN	statut ON statut.statut_id = plan.z_statut_id\n	LEFT JOIN	plan PPLAN ON PPLAN.code_wbs = SUBSTRING_INDEX( plan.code_wbs, \'.\', 1 )\n	LEFT JOIN	v_objectif PPLAN_OBJECTIF ON PPLAN_OBJECTIF.objectif_id = PPLAN.objectif_id\n\n	LEFT JOIN	plan N1 ON N1.plan_id = plan.parent_id \n	LEFT JOIN	objectif ON1 ON ON1.objectif_id = N1.objectif_id\n\n	LEFT JOIN	plan N2 ON N2.plan_id = N1.parent_id \n	LEFT JOIN	objectif ON2 ON ON2.objectif_id = N2.objectif_id\n\n	LEFT JOIN	plan N3 ON N3.plan_id = N2.parent_id\n	LEFT JOIN	objectif ON3 ON ON3.objectif_id = N3.objectif_id\n\n	LEFT JOIN	plan N4 ON N4.plan_id = N3.parent_id\n	LEFT JOIN	objectif ON4 ON ON4.objectif_id = N4.objectif_id\n\n	LEFT JOIN	plan N5 ON N5.plan_id = N4.parent_id\n	LEFT JOIN	objectif ON5 ON ON5.objectif_id = N5.objectif_id\n\n	LEFT JOIN	plan N6 ON N6.plan_id = N5.parent_id\n	LEFT JOIN	objectif ON6 ON ON6.objectif_id = N6.objectif_id\n\n	LEFT JOIN	plan N7 ON N7.plan_id = N6.parent_id\n	LEFT JOIN	objectif ON7 ON ON7.objectif_id = N7.objectif_id;
client_cs_name=utf8mb4
connection_cl_name=utf8mb4_unicode_ci
view_body_utf8=select `cbwebca_bd01`.`plan`.`plan_id` AS `plan_id`,`cbwebca_bd01`.`plan`.`parent_id` AS `parent_id`,`cbwebca_bd01`.`plan`.`objectif_id` AS `objectif_id`,`cbwebca_bd01`.`plan`.`code` AS `code`,`cbwebca_bd01`.`plan`.`poids` AS `poids`,`cbwebca_bd01`.`plan`.`note` AS `note`,substring_index(`cbwebca_bd01`.`plan`.`code_wbs`,\'.\',1) AS `plan_code_wbs`,concat(substring_index(`cbwebca_bd01`.`plan`.`code_wbs`,\'.\',1),\'-\',`pplan_objectif`.`libelle`) AS `plan_libelle`,`cbwebca_bd01`.`plan`.`code_wbs` AS `code_wbs`,`cbwebca_bd01`.`plan`.`niveau` AS `niveau`,`v_objectif`.`type_objectif_id` AS `type_objectif_id`,`v_objectif`.`type_objectif_code` AS `type_objectif_code`,`v_objectif`.`type_objectif_libelle` AS `type_objectif_libelle`,`v_objectif`.`type_objectif_css` AS `type_objectif_css`,`v_objectif`.`type_objectif_classe` AS `type_objectif_classe`,`v_objectif`.`libelle` AS `libelle`,`v_objectif`.`descr` AS `descr`,`v_objectif`.`code` AS `objectif_code`,`v_objectif`.`debut_date` AS `debut_date`,`v_objectif`.`fin_date` AS `fin_date`,`v_objectif`.`attributs` AS `attributs`,`v_objectif`.`attributs_desc` AS `attributs_desc`,`v_objectif`.`responsable_personnel_id` AS `responsable_personnel_id`,`v_objectif`.`responsable_nom` AS `responsable_nom`,`v_objectif`.`responsable_prenom` AS `responsable_prenom`,`v_objectif`.`responsable_courriel` AS `responsable_courriel`,`v_objectif`.`responsable_departement_id` AS `responsable_departement_id`,`v_objectif`.`responsable_departement_code` AS `responsable_departement_code`,`v_objectif`.`responsable_direction_id` AS `responsable_direction_id`,`v_objectif`.`responsable_direction_code` AS `responsable_direction_code`,`v_objectif`.`reddition_date` AS `reddition_date`,`v_objectif`.`budget_effectif_date` AS `budget_effectif_date`,`v_objectif`.`codes_reddition_codes` AS `codes_reddition_codes`,`v_objectif`.`codes_reddition_codes_desc` AS `codes_reddition_codes_desc`,`v_objectif`.`attribut_decompte` AS `attribut_decompte`,`v_objectif`.`personnel_decompte` AS `personnel_decompte`,`v_objectif`.`plan_decompte` AS `plan_decompte`,`v_objectif`.`valeur_decompte` AS `valeur_decompte`,`v_objectif`.`budget_decompte` AS `budget_decompte`,`v_objectif`.`reddition_decompte` AS `reddition_decompte`,`v_objectif`.`suivi_decompte` AS `suivi_decompte`,(select count(0) from `cbwebca_bd01`.`plan` `a` where `a`.`plan_id` = `cbwebca_bd01`.`plan`.`parent_id`) AS `plan_parent_decompte`,(select count(0) from `cbwebca_bd01`.`plan` `a` where `a`.`parent_id` = `cbwebca_bd01`.`plan`.`plan_id`) AS `plan_enfant_decompte`,`v_objectif`.`cible` AS `cible`,`v_objectif`.`sens` AS `sens`,case when `v_objectif`.`sens` = \'HAUT\' then 1 else 0 end AS `sens_no`,`v_objectif`.`valeur` AS `valeur`,`v_objectif`.`valeur_effectif_date` AS `valeur_effectif_date`,`v_objectif`.`cible_ecart` AS `cible_ecart`,`v_objectif`.`cible_completion` AS `cible_completion`,`v_objectif`.`ind_termine` AS `ind_termine`,if(`v_objectif`.`statut_id` = 60 or `cbwebca_bd01`.`plan`.`z_statut_id` = 60,NULL,if(`v_objectif`.`reddition_date` is null,`cbwebca_bd01`.`plan`.`decompte`,1)) AS `decompte`,if(`v_objectif`.`statut_id` = 60 or `cbwebca_bd01`.`plan`.`z_statut_id` = 60,NULL,if(`v_objectif`.`reddition_date` is null,`cbwebca_bd01`.`plan`.`completion_pourcent_total`,`v_objectif`.`completion_pourcent`)) AS `completion_pourcent_total`,if(`v_objectif`.`statut_id` = 60 or `cbwebca_bd01`.`plan`.`z_statut_id` = 60,NULL,if(`v_objectif`.`reddition_date` is null,`cbwebca_bd01`.`plan`.`termine_decompte`,`v_objectif`.`termine_decompte`)) AS `termine_decompte`,if(`v_objectif`.`statut_id` = 60 or `cbwebca_bd01`.`plan`.`z_statut_id` = 60,NULL,if(`v_objectif`.`reddition_date` is null,ifnull(`cbwebca_bd01`.`plan`.`reddition_debut_date`,`v_objectif`.`debut_date`),`v_objectif`.`reddition_debut_date`)) AS `reddition_debut_date`,if(`v_objectif`.`statut_id` = 60 or `cbwebca_bd01`.`plan`.`z_statut_id` = 60,NULL,if(`v_objectif`.`reddition_date` is null,ifnull(`cbwebca_bd01`.`plan`.`reddition_fin_date`,`v_objectif`.`fin_date`),`v_objectif`.`reddition_fin_date`)) AS `reddition_fin_date`,if(`v_objectif`.`statut_id` = 60 or `cbwebca_bd01`.`plan`.`z_statut_id` = 60,NULL,if(`v_objectif`.`budget_effectif_date` is null,`cbwebca_bd01`.`plan`.`budget_total`,`v_objectif`.`budget_total`)) AS `budget_total`,if(`v_objectif`.`statut_id` = 60 or `cbwebca_bd01`.`plan`.`z_statut_id` = 60,NULL,if(`v_objectif`.`budget_effectif_date` is null,`cbwebca_bd01`.`plan`.`budget_depense`,`v_objectif`.`budget_depense`)) AS `budget_depense`,if(`v_objectif`.`statut_id` = 60 or `cbwebca_bd01`.`plan`.`z_statut_id` = 60,NULL,if(`v_objectif`.`budget_effectif_date` is null,`cbwebca_bd01`.`plan`.`budget_engage`,`v_objectif`.`budget_engage`)) AS `budget_engage`,case when `v_objectif`.`reddition_date` is not null then `v_objectif`.`duree` else to_days(`cbwebca_bd01`.`plan`.`reddition_fin_date`) - to_days(`cbwebca_bd01`.`plan`.`reddition_debut_date`) end AS `duree`,case when `v_objectif`.`reddition_date` is not null then `v_objectif`.`jours_restants` else case when to_days(`cbwebca_bd01`.`plan`.`fin_date`) - to_days(`cbwebca_bd01`.`plan`.`reddition_date`) < 0 then 0 else to_days(`cbwebca_bd01`.`plan`.`fin_date`) - to_days(`cbwebca_bd01`.`plan`.`reddition_date`) end end AS `jours_restants`,case when `v_objectif`.`reddition_date` is not null then `v_objectif`.`cycle_pourcent` else case when round((to_days(`cbwebca_bd01`.`plan`.`fin_date`) - to_days(`cbwebca_bd01`.`plan`.`reddition_date`)) * 100 / (to_days(`cbwebca_bd01`.`plan`.`fin_date`) - to_days(`cbwebca_bd01`.`plan`.`reddition_debut_date`)),0) < 0 then 0 else round((to_days(`cbwebca_bd01`.`plan`.`fin_date`) - to_days(`cbwebca_bd01`.`plan`.`reddition_date`)) * 100 / (to_days(`cbwebca_bd01`.`plan`.`fin_date`) - to_days(`cbwebca_bd01`.`plan`.`reddition_debut_date`)),0) end end AS `cycle_pourcent`,case when `v_objectif`.`reddition_date` is not null then `v_objectif`.`completion_pourcent` else round(`cbwebca_bd01`.`plan`.`completion_pourcent_total` / `cbwebca_bd01`.`plan`.`decompte`,0) end AS `completion_pourcent`,case when `v_objectif`.`reddition_date` is not null then `v_objectif`.`termine_decompte` else round(`cbwebca_bd01`.`plan`.`termine_decompte` * 100 / `cbwebca_bd01`.`plan`.`decompte`,0) end AS `termine_pourcent`,case when `v_objectif`.`budget_effectif_date` is not null then round((`v_objectif`.`budget_depense` + `v_objectif`.`budget_engage`) * 100 / `v_objectif`.`budget_total`,0) else round((`cbwebca_bd01`.`plan`.`budget_depense` + `cbwebca_bd01`.`plan`.`budget_engage`) * 100 / `cbwebca_bd01`.`plan`.`budget_total`,0) end AS `budget_pourcent`,`cbwebca_bd01`.`statut`.`statut_id` AS `statut_id`,`cbwebca_bd01`.`statut`.`css` AS `statut_css`,`cbwebca_bd01`.`statut`.`icone` AS `statut_icone`,`cbwebca_bd01`.`statut`.`libelle` AS `statut`,case when `n1`.`niveau` = 1 then left(concat(`n1`.`code_wbs`,\'-\',`on1`.`libelle`),500) when `n2`.`niveau` = 1 then left(concat(`n2`.`code_wbs`,\'-\',`on2`.`libelle`),500) when `n3`.`niveau` = 1 then left(concat(`n3`.`code_wbs`,\'-\',`on3`.`libelle`),500) when `n4`.`niveau` = 1 then left(concat(`n4`.`code_wbs`,\'-\',`on4`.`libelle`),500) when `n5`.`niveau` = 1 then left(concat(`n5`.`code_wbs`,\'-\',`on5`.`libelle`),500) when `n6`.`niveau` = 1 then left(concat(`n6`.`code_wbs`,\'-\',`on6`.`libelle`),500) when `n7`.`niveau` = 1 then left(concat(`n7`.`code_wbs`,\'-\',`on7`.`libelle`),500) end AS `plan_niveau_1`,case when `n1`.`niveau` = 2 then left(concat(`n1`.`code_wbs`,\'-\',`on1`.`libelle`),500) when `n2`.`niveau` = 2 then left(concat(`n2`.`code_wbs`,\'-\',`on2`.`libelle`),500) when `n3`.`niveau` = 2 then left(concat(`n3`.`code_wbs`,\'-\',`on3`.`libelle`),500) when `n4`.`niveau` = 2 then left(concat(`n4`.`code_wbs`,\'-\',`on4`.`libelle`),500) when `n5`.`niveau` = 2 then left(concat(`n5`.`code_wbs`,\'-\',`on5`.`libelle`),500) when `n6`.`niveau` = 2 then left(concat(`n6`.`code_wbs`,\'-\',`on6`.`libelle`),500) when `n7`.`niveau` = 2 then left(concat(`n7`.`code_wbs`,\'-\',`on7`.`libelle`),500) end AS `plan_niveau_2`,case when `n1`.`niveau` = 3 then left(concat(`n1`.`code_wbs`,\'-\',`on1`.`libelle`),500) when `n2`.`niveau` = 3 then left(concat(`n2`.`code_wbs`,\'-\',`on2`.`libelle`),500) when `n3`.`niveau` = 3 then left(concat(`n3`.`code_wbs`,\'-\',`on3`.`libelle`),500) when `n4`.`niveau` = 3 then left(concat(`n4`.`code_wbs`,\'-\',`on4`.`libelle`),500) when `n5`.`niveau` = 3 then left(concat(`n5`.`code_wbs`,\'-\',`on5`.`libelle`),500) when `n6`.`niveau` = 3 then left(concat(`n6`.`code_wbs`,\'-\',`on6`.`libelle`),500) when `n7`.`niveau` = 3 then left(concat(`n7`.`code_wbs`,\'-\',`on7`.`libelle`),500) end AS `plan_niveau_3`,case when `n1`.`niveau` = 4 then left(concat(`n1`.`code_wbs`,\'-\',`on1`.`libelle`),500) when `n2`.`niveau` = 4 then left(concat(`n2`.`code_wbs`,\'-\',`on2`.`libelle`),500) when `n3`.`niveau` = 4 then left(concat(`n3`.`code_wbs`,\'-\',`on3`.`libelle`),500) when `n4`.`niveau` = 4 then left(concat(`n4`.`code_wbs`,\'-\',`on4`.`libelle`),500) when `n5`.`niveau` = 4 then left(concat(`n5`.`code_wbs`,\'-\',`on5`.`libelle`),500) when `n6`.`niveau` = 4 then left(concat(`n6`.`code_wbs`,\'-\',`on6`.`libelle`),500) when `n7`.`niveau` = 4 then left(concat(`n7`.`code_wbs`,\'-\',`on7`.`libelle`),500) end AS `plan_niveau_4`,case when `n1`.`niveau` = 5 then left(concat(`n1`.`code_wbs`,\'-\',`on1`.`libelle`),500) when `n2`.`niveau` = 5 then left(concat(`n2`.`code_wbs`,\'-\',`on2`.`libelle`),500) when `n3`.`niveau` = 5 then left(concat(`n3`.`code_wbs`,\'-\',`on3`.`libelle`),500) when `n4`.`niveau` = 5 then left(concat(`n4`.`code_wbs`,\'-\',`on4`.`libelle`),500) when `n5`.`niveau` = 5 then left(concat(`n5`.`code_wbs`,\'-\',`on5`.`libelle`),500) when `n6`.`niveau` = 5 then left(concat(`n6`.`code_wbs`,\'-\',`on6`.`libelle`),500) when `n7`.`niveau` = 5 then left(concat(`n7`.`code_wbs`,\'-\',`on7`.`libelle`),500) end AS `plan_niveau_5`,case when `n1`.`niveau` = 6 then left(concat(`n1`.`code_wbs`,\'-\',`on1`.`libelle`),500) when `n2`.`niveau` = 6 then left(concat(`n2`.`code_wbs`,\'-\',`on2`.`libelle`),500) when `n3`.`niveau` = 6 then left(concat(`n3`.`code_wbs`,\'-\',`on3`.`libelle`),500) when `n4`.`niveau` = 6 then left(concat(`n4`.`code_wbs`,\'-\',`on4`.`libelle`),500) when `n5`.`niveau` = 6 then left(concat(`n5`.`code_wbs`,\'-\',`on5`.`libelle`),500) when `n6`.`niveau` = 6 then left(concat(`n6`.`code_wbs`,\'-\',`on6`.`libelle`),500) when `n7`.`niveau` = 6 then left(concat(`n7`.`code_wbs`,\'-\',`on7`.`libelle`),500) end AS `plan_niveau_6`,case when `n1`.`niveau` = 7 then left(concat(`n1`.`code_wbs`,\'-\',`on1`.`libelle`),500) when `n2`.`niveau` = 7 then left(concat(`n2`.`code_wbs`,\'-\',`on2`.`libelle`),500) when `n3`.`niveau` = 7 then left(concat(`n3`.`code_wbs`,\'-\',`on3`.`libelle`),500) when `n4`.`niveau` = 7 then left(concat(`n4`.`code_wbs`,\'-\',`on4`.`libelle`),500) when `n5`.`niveau` = 7 then left(concat(`n5`.`code_wbs`,\'-\',`on5`.`libelle`),500) when `n6`.`niveau` = 7 then left(concat(`n6`.`code_wbs`,\'-\',`on6`.`libelle`),500) when `n7`.`niveau` = 7 then left(concat(`n7`.`code_wbs`,\'-\',`on7`.`libelle`),500) end AS `plan_niveau_7` from ((((((((((((((((((`cbwebca_bd01`.`plan` join `cbwebca_bd01`.`v_objectif` on(`v_objectif`.`objectif_id` = `cbwebca_bd01`.`plan`.`objectif_id`)) left join `cbwebca_bd01`.`statut` on(`cbwebca_bd01`.`statut`.`statut_id` = `cbwebca_bd01`.`plan`.`z_statut_id`)) left join `cbwebca_bd01`.`plan` `pplan` on(`pplan`.`code_wbs` = substring_index(`cbwebca_bd01`.`plan`.`code_wbs`,\'.\',1))) left join `cbwebca_bd01`.`v_objectif` `pplan_objectif` on(`pplan_objectif`.`objectif_id` = `pplan`.`objectif_id`)) left join `cbwebca_bd01`.`plan` `n1` on(`n1`.`plan_id` = `cbwebca_bd01`.`plan`.`parent_id`)) left join `cbwebca_bd01`.`objectif` `on1` on(`on1`.`objectif_id` = `n1`.`objectif_id`)) left join `cbwebca_bd01`.`plan` `n2` on(`n2`.`plan_id` = `n1`.`parent_id`)) left join `cbwebca_bd01`.`objectif` `on2` on(`on2`.`objectif_id` = `n2`.`objectif_id`)) left join `cbwebca_bd01`.`plan` `n3` on(`n3`.`plan_id` = `n2`.`parent_id`)) left join `cbwebca_bd01`.`objectif` `on3` on(`on3`.`objectif_id` = `n3`.`objectif_id`)) left join `cbwebca_bd01`.`plan` `n4` on(`n4`.`plan_id` = `n3`.`parent_id`)) left join `cbwebca_bd01`.`objectif` `on4` on(`on4`.`objectif_id` = `n4`.`objectif_id`)) left join `cbwebca_bd01`.`plan` `n5` on(`n5`.`plan_id` = `n4`.`parent_id`)) left join `cbwebca_bd01`.`objectif` `on5` on(`on5`.`objectif_id` = `n5`.`objectif_id`)) left join `cbwebca_bd01`.`plan` `n6` on(`n6`.`plan_id` = `n5`.`parent_id`)) left join `cbwebca_bd01`.`objectif` `on6` on(`on6`.`objectif_id` = `n6`.`objectif_id`)) left join `cbwebca_bd01`.`plan` `n7` on(`n7`.`plan_id` = `n6`.`parent_id`)) left join `cbwebca_bd01`.`objectif` `on7` on(`on7`.`objectif_id` = `n7`.`objectif_id`))
mariadb-version=100508
